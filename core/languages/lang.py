import subprocess
import os

def get_language(exploit):
    exploit_path = exploit.get_local_path()
    filename = os.path.basename(exploit_path)
    if filename.split('.')[1] == 'txt':
        cmd = "file "+ exploit_path
        language = str(subprocess.check_output(cmd, shell=True))
        language = language.split(": ")[1].split()[0].lower()
        if(language == "python"):
            language = "py"
        elif(language == "c++"):
            language = "cpp"
        elif(language == "ruby"):
            language = "rb"
        elif(language == "exported"):
            language = "sgml"
        elif(language == "unified"):
            language = "diff"
        elif(language == "perl5"):
            language = "perl"
    else:
        language = filename.split('.')[1]

    exploit.language = language
    return language