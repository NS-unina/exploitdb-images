package edb

import (
	"fmt"
	"strings"

	"github.com/cybersecsi/exploitdb-images/core/utils"
)

const EDB_MASTER = "https://raw.githubusercontent.com/offensive-security/exploitdb/master/"
const EDB_FILES = "https://raw.githubusercontent.com/offensive-security/exploitdb/master/files_exploits.csv"

type Edb struct {
	id          string
	file        string
	description string
	date        string
	author      string
	the_type    string
	platform    string
}

func GetExploit(path string) string {
	exploit_code := utils.HttpGet(EDB_MASTER + path)
	return exploit_code
}

func GetExploitPath(path string) string {
	return EDB_MASTER + path
}

func GetExploits(csv_content [][]string) []Edb {
	return make([]Edb, 10)
}

func GetRemoteExploits() []Edb {
	for _, entry := range utils.ReadRemoteCsv(EDB_FILES) {
		fmt.Println(entry[0])

	}
	return make([]Edb, 10)
}

func GetLocalExploits(path string) []Edb {
	results := utils.ReadCsvFile(path)
	var exploits []Edb
	for _, entry := range results {
		exploits = append(exploits, Edb{
			id:          strings.TrimSpace(entry[0]),
			file:        strings.TrimSpace(entry[1]),
			description: strings.TrimSpace(entry[2]),
			date:        strings.TrimSpace(entry[3]),
			author:      strings.TrimSpace(entry[4]),
			the_type:    strings.TrimSpace(entry[5]),
			platform:    strings.TrimSpace(entry[6])})
	}
	return exploits

}
