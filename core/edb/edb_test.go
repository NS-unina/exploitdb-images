package edb 
import (
	"path/filepath"
    "runtime"
    "testing"
	"fmt"
)


var (
    _, b, _, _ = runtime.Caller(0)
    basepath   = filepath.Dir(b)
    root = filepath.Join(filepath.Dir(b), "../..")
	testData = filepath.Join(root, "test", "exploit.csv")
)

func PrintMyPath() {
    fmt.Println(testData)
}

func TestExploits(t *testing.T) {
	expected := Edb{"9", "exploits/windows/dos/9.c", "Apache 2.x - Memory Leak","1970-01-01", "Mattew Murphy", "dos", "windows"}
	exploits := GetLocalExploits(testData)

	if len(exploits) != 6 || exploits[0].id != expected.id {
		t.Errorf("Not valid : length: %d expected: 6", len(exploits))
		t.Errorf("expected: %s, obtained: %s", expected, exploits[0])
	}

}