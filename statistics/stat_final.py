import pandas as pd
import os

f = open(os.path.join('results','statistics_final.txt'), 'w')
df = pd.read_csv(os.path.join('results', 'exit_code.csv'))

# block 1 - simple stats
mean1 = df['ex_time'].mean()
sum1 = df['ex_time'].sum()
max1 = df['ex_time'].max()
min1 = df['ex_time'].min()
count1 = df['ex_time'].count()
median1 = df['ex_time'].median() 
std1 = df['ex_time'].std() 
var1 = df['ex_time'].var()  

# block 2 - group by
groupby_count1 = df.groupby(['exit_code']).count()

# execution times - intervals
bins = [0, 1, 2, 5, 10, 20, 50, 100, 1000, 10000]
df_ranges = df['ex_time'].value_counts(bins=bins, sort=False)
df_ranges.to_csv('time_ranges.csv')

# print block 1
f.write('mean execution time: ' + str(mean1) + '\n')
f.write('sum of execution times: ' + str(sum1)+ '\n')
f.write('max execution time: ' + str(max1)+ '\n')
f.write('min execution time: ' + str(min1)+ '\n')
f.write('count of execution times: ' + str(count1)+ '\n')
f.write('median execution time: ' + str(median1)+ '\n')
f.write('std of execution time: ' + str(std1)+ '\n')
f.write('var of execution time: ' + str(var1)+ '\n')

# print block 2
f.write('count of values, grouped by the exit code: ' + str(groupby_count1)+ '\n')
f.write('execution times ranges: '+ str(df_ranges))



f.close()


