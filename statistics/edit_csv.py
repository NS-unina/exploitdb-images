import sys
sys.path.append('..')
from core.languages import lang
import os

import pandas as pd

#Read csv

path = os.path.join('..','exploitdb_repo','files_exploits.csv')
df = pd.read_csv(path)
#Add new column for snippet extension
df['ext'] = df['file'].str.split('.', n=1, expand=True)[1]

#Add new column for snippet language
df['language'] = df['file'].apply(lang.get_language)

#Save edited dataset on new csv
df.to_csv('files_exploit_lang.csv', index=False)