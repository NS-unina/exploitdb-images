import subprocess

def get_language(exploit):
    if exploit.split('.')[1] == 'txt':
        cmd = "file ../exploitdb_repo/"+ exploit
        language = str(subprocess.check_output(cmd, shell=True))
        language = language.split(": ")[1].split()[0].lower()
        if(language == "python"):
            language = "py"
        elif(language == "c++"):
            language = "cpp"
        elif(language == "ruby"):
            language = "rb"
        elif(language == "exported"):
            language = "sgml"
        elif(language == "unified"):
            language = "diff"
        elif(language == "perl5"):
            language = "perl"
    else:
        language = exploit.split('.')[1]
    return language